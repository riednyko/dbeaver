<?xml version="1.0" encoding="UTF-8"?>
<?eclipse version="3.2"?>

<plugin>

<extension point="org.jkiss.dbeaver.dataSourceProvider">

        <!-- H2GIS driver -->
        <datasource
                class="org.jkiss.dbeaver.ext.h2gis.H2GISDataSourceProvider"
                description="%datasource.h2gis.description"
                id="h2gis"
                parent="generic"
                label="H2GIS"
                icon="icons/h2gis_icon.png">
            <drivers managable="true">

                <driver
                    id="h2gis_embedded"
                    label="H2GIS Embedded"
                    icon="icons/h2gis_icon.png"
                    iconBig="icons/h2gis_icon_big.png"
                    category="H2GIS"
                    class="org.h2.Driver"
                    sampleURL="jdbc:h2:{database}"
                    webURL="http://www.h2gis.org/"
                    embedded="true"
                    description="H2GIS Embedded"
                    categories="spatial,sql,embedded">
                    <replace provider="generic" driver="h2gis_embedded"/>

                    <file type="jar" path="maven:/org.orbisgis:h2gis:RELEASE" bundle="!drivers.h2"/>

                    <file type="jar" path="drivers/h2gis/h2gis.jar" bundle="drivers.h2"/>

                    <parameter name="query-get-active-db" value="SELECT SCHEMA()"/>
                    <parameter name="query-set-active-db" value="SET SCHEMA = ?"/>
                    <parameter name="query-shutdown" value="shutdown"/>
                    <parameter name="omit-catalog" value="true"/>
                </driver>

		<driver
                    id="h2gis_server"
                    label="H2GIS Server"
                    icon="icons/h2gis_icon.png"
                    iconBig="icons/h2gis_icon_big.png"
                    category="H2GIS"
                    class="org.h2.Driver"
                    sampleURL="jdbc:h2:tcp://{host}[:{port}]/{database}"
                    defaultPort="9092"
                    webURL="http://www.h2gis.org/"
                    description="H2GIS Embedded"
                    categories="spatial,sql,server">
                    <replace provider="generic" driver="h2gis_server"/>

                    <file type="jar" path="maven:/org.orbisgis:h2gis:RELEASE" bundle="!drivers.h2"/>

                    <file type="jar" path="drivers/h2gis/h2gis.jar" bundle="drivers.h2"/>

                    <parameter name="query-get-active-db" value="SELECT SCHEMA()"/>
                    <parameter name="query-set-active-db" value="SET SCHEMA = ?"/>
                    <parameter name="query-shutdown" value="shutdown"/>
                    <parameter name="omit-catalog" value="true"/>
                </driver>

            </drivers>

        </datasource>
    </extension>

    <extension point="org.jkiss.dbeaver.generic.meta">
        <meta id="h2gis" class="org.jkiss.dbeaver.ext.h2gis.model.H2GISMetaModel" driverClass="org.h2.Driver"/>
    </extension>

</plugin>
